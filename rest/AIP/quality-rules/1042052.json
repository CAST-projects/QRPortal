{
    "id": 1042052,
    "name": "Avoid using JSON-lib library for Rest Plugin of Struts 2.5 to 2.5.14",
    "href": "AIP/quality-rules/1042052",
    "critical": true,
    "maxWeight": 8,
    "associatedValueName": "Number of violation occurrences",
    "description": "This rule will check if JSON-lib library is used when used version is Struts 2.5 to 2.5.14. If yes, it gives violation.",
    "output": "Associated to each violation, the following information is provided:\n- The number of violation occurrences\n- Bookmarks for violation occurrences found in the source code",
    "rationale": "In Apache Struts 2.5 to 2.5.14, the REST Plugin is using an outdated JSON-lib library which is vulnerable and allow perform a DoS attack using malicious request with specially crafted JSON payload.",
    "reference": "https://nvd.nist.gov/vuln/detail/CVE-2017-15707\nhttps://cwiki.apache.org/confluence/display/WW/S2-054\nhttps://cwiki.apache.org/confluence/display/WW/REST+Plugin#RESTPlugin-UseJacksonframeworkasJSONContentTypeHandler",
    "remediation": "Use Jackson handler instead of the default JSON-lib handler.\nUpgrade to Struts 2.5.14.1",
    "remediationSample": "Upgrade to Struts 2.5.14.1\n\n---\nOverwrite the Content Handler with the Jackson Content Handler in the struts.xml:\n\n<bean type=\"org.apache.struts2.rest.handler.ContentTypeHandler\" name=\"jackson\" class=\"org.apache.struts2.rest.handler.JacksonLibHandler\"/>\n<constant name=\"struts.rest.handlerOverride.json\" value=\"jackson\"/>\n \n<!-- Set to false if the json content can be returned for any kind of http method -->\n<constant name=\"struts.rest.content.restrictToGET\" value=\"false\"/>\n \n<!-- Set encoding to UTF-8, default is ISO-8859-1 -->\n<constant name=\"struts.i18n.encoding\" value=\"UTF-8\"/>",
    "sample": "<struts>\n\n  <package name=\"example\"  extends=\"json-default\">\n     <action name=\"JSONExample\" class=\"example.JSONExample\">\n        <result type=\"json\"/>\n     </action>\n  </package>\n\n</struts>\n\n---------------------------------------\n<struts>\n  <package name=\"employee\" extends=\"struts-default, json-default\" namespace=\"/employee\">\n\n    <action name=\"list\" method=\"list\" \n                     class=\"org.apache.struts2.showcase.action.EmployeeAction\" >\n        <result>/empmanager/listEmployees.jsp</result>\n        <result type=\"json\">\n            <param name=\"root\">employees</param>\n        </result>\n    </action>\n\n  </package>\n</struts>",
    "total": "Number of Struts 2.x config XML file",
    "alternativeName": "Ensure not using JSON-lib library for Rest Plugin of Struts 2.5 to 2.5.14",
    "businessCriteria": [
        {
            "id": 20140522,
            "name": "GreenIT-Index",
            "href": "AIP/business-criteria/20140522"
        },
        {
            "id": 1061000,
            "name": "ISO-5055-Index",
            "href": "AIP/business-criteria/1061000"
        },
        {
            "id": 1061004,
            "name": "ISO-5055-Security",
            "href": "AIP/business-criteria/1061004"
        },
        {
            "id": 1062300,
            "name": "OWASP-2013-Index",
            "href": "AIP/business-criteria/1062300"
        },
        {
            "id": 1062320,
            "name": "OWASP-2017-Index",
            "href": "AIP/business-criteria/1062320"
        },
        {
            "id": 60016,
            "name": "Security",
            "href": "AIP/business-criteria/60016"
        }
    ],
    "technicalCriteria": [
        {
            "id": 1061059,
            "name": "CWE-502: Deserialization of Untrusted Data",
            "weight": 5,
            "critical": false
        },
        {
            "id": 1062309,
            "name": "OWASP-2013-A9 Using Components with Known Vulnerabilities",
            "weight": 5,
            "critical": false
        },
        {
            "id": 1062328,
            "name": "OWASP-2017-A8 Insecure Deserialization",
            "weight": 5,
            "critical": false
        },
        {
            "id": 1062329,
            "name": "OWASP-2017-A9 Using Components with Known Vulnerabilities",
            "weight": 5,
            "critical": false
        },
        {
            "id": 66064,
            "name": "Secure Coding - Weak Security Features",
            "weight": 8,
            "critical": true
        }
    ],
    "technologies": [
        {
            "id": 140029,
            "name": "JEE",
            "href": "AIP/technologies/140029"
        }
    ],
    "qualityStandards": [
        {
            "standard": "CWE",
            "id": "CWE-502",
            "name": "Deserialization of Untrusted Data",
            "url": "https://cwe.mitre.org/data/definitions/502.html",
            "description": "The application deserializes untrusted data without sufficiently verifying that the resulting data will be valid."
        },
        {
            "standard": "CWE",
            "id": "CWE-676",
            "name": "Use of Potentially Dangerous Function",
            "url": "https://cwe.mitre.org/data/definitions/676.html",
            "description": "The program invokes a potentially dangerous function that could introduce a vulnerability if it is used incorrectly, but the function can also be used safely."
        },
        {
            "standard": "ISO-5055",
            "id": "CWE-502",
            "name": "Deserialization of Untrusted Data",
            "url": "https://cwe.mitre.org/data/definitions/502.html",
            "description": "The application deserializes untrusted data without sufficiently verifying that the resulting data will be valid."
        },
        {
            "standard": "OMG-ASCQM",
            "id": "CWE-502",
            "name": "Deserialization of Untrusted Data",
            "url": "https://cwe.mitre.org/data/definitions/502.html",
            "description": "The application deserializes untrusted data without sufficiently verifying that the resulting data will be valid."
        },
        {
            "standard": "OWASP",
            "id": "A8-2017",
            "name": "Insecure Deserialization",
            "url": "https://www.owasp.org/index.php/Top_10-2017_A8-Insecure_Deserialization",
            "description": "Insecure deserialization often leads to remote code execution. Even if deserialization flaws do not result in remote code execution, they can be used to perform attacks, including replay attacks, injection attacks, and privilege escalation attacks."
        },
        {
            "standard": "OWASP",
            "id": "A9-2013",
            "name": "Using Components with Known Vulnerabilities",
            "url": "https://www.owasp.org/index.php/Top_10_2013-A9-Using_Components_with_Known_Vulnerabilities",
            "description": "Components, such as libraries, frameworks, and other software modules, almost always run with full privileges. If a vulnerable component is exploited, such an attack can facilitate serious data loss or server takeover. Applications using components with known vulnerabilities may undermine application defenses and enable a range of possible attacks and impacts."
        },
        {
            "standard": "OWASP",
            "id": "A9-2017",
            "name": "Using Components with Known Vulnerabilities",
            "url": "https://www.owasp.org/index.php/Top_10-2017_A9-Using_Components_with_Known_Vulnerabilities",
            "description": "Components, such as libraries, frameworks, and other software modules, run with the same privileges as the application. If a vulnerable component is exploited, such an attack can facilitate serious data loss or server takeover. Applications and APIs using components with known vulnerabilities may undermine application defenses and enable various attacks and impacts."
        }
    ],
    "parameters": [
        
    ],
    "thresholds": [
        98.0,
        99.0,
        99.5,
        99.99
    ]
}
