{
    "id": 1042042,
    "name": "Avoid using Rest Plugin with XStream handler for Struts 2.1.2 - Struts 2.3.33, Struts 2.5 - Struts 2.5.12",
    "href": "AIP/quality-rules/1042042",
    "critical": true,
    "associatedValueName": "Number of violation occurrences",
    "description": "This vulnerability is specifically related to Struts REST Plugin, when it uses XML for exchanging data between the Clients and the Server. The main functionality of the REST plugin lies in the interpretation of incoming request URL\u2019s according to the RESTful rules and uses serialization to convert the data structures or object into a stream of bytes for ease in storing or transmitting, which can then be reconstructed. It is during the process of reconstruction that XStream handler, that can lead to RCE with Struts 2.1.2 - Struts  2.3.33, Struts 2.5 - Struts 2.5.12.",
    "output": "Associated to each violation, the following information is provided:\n- The number of violation occurrences\n- Bookmarks for violation occurrences found in the source code",
    "rationale": "Components, such as libraries, frameworks, and other software modules, almost always run with full privileges. If a vulnerable component is exploited, such an attack can facilitate serious data loss or server takeover. Applications using components with known vulnerabilities may undermine application defenses and enable a range of possible attacks and impacts.\n\nThe REST Plugin is using a XStreamHandler with an instance of XStream for deserialization without any type filtering and this can lead to Remote Code Execution when deserializing XML payloads.",
    "reference": "https://cwiki.apache.org/confluence/display/WW/S2-052\nhttps://nvd.nist.gov/vuln/detail/CVE-2017-9805\nhttps://www.owasp.org/index.php/Top_10-2017_A8-Insecure_Deserialization\n\nOWASP Top 10 2017 -A8-Insecure_Deserialization",
    "remediation": "Upgrade to Apache Struts version 2.5.13 or 2.3.34.",
    "remediationSample": "Upgrade to Apache Struts version 2.5.13 or 2.3.34.\n\nhttps://cwiki.apache.org/confluence/display/WW/Version+Notes+2.3.34\nhttps://cwiki.apache.org/confluence/display/WW/Version+Notes+2.5.13\n\nRemediation sample code :\n\n<bean type=\"org.apache.struts2.rest.handler.ContentTypeHandler\" name=\"xml\" class=\"org.apache.struts2.rest.handler.XStreamHandler\">\n\n.....\n\n<constant name=\"struts.action.extension\" value=\"xhtml,json\" />",
    "sample": "Sample code :\n\n<bean type=\"org.apache.struts2.rest.handler.ContentTypeHandler\" name=\"xml\" class=\"org.apache.struts2.rest.handler.XStreamHandler\">\n\n.....\n\n<constant name=\"struts.action.extension\" value=\"xhtml,xml,json\" />",
    "total": "Number of struts2 config XML file",
    "alternativeName": "Avoid using Rest Plugin with XStream handler for Struts 2.1.2 - Struts 2.3.33, Struts 2.5 - Struts 2.5.12",
    "businessCriteria": [
        {
            "id": 20140522,
            "name": "Green Stuff",
            "href": "AIP/business-criteria/20140522"
        },
        {
            "id": 60016,
            "name": "Security",
            "href": "AIP/business-criteria/60016"
        }
    ],
    "technicalCriteria": [
        {
            "id": 66064,
            "name": "Secure Coding - Weak Security Features",
            "weight": 8,
            "critical": true
        }
    ],
    "technologies": [
        {
            "id": 140029,
            "name": "JEE",
            "href": "AIP/technologies/140029"
        }
    ],
    "qualityStandards": [
        {
            "standard": "OWASP",
            "id": "A4-2017",
            "name": "XML External Entities (XXE)",
            "url": "https://www.owasp.org/index.php/Top_10-2017_A4-XML_External_Entities_(XXE)",
            "description": "Many older or poorly configured XML processors evaluate external entity references within XML documents. External entities can be used to disclose internal files using the file URI handler, internal file shares, internal port scanning, remote code execution, and denial of service attacks."
        }
    ],
    "parameters": [
        
    ],
    "thresholds": [
        98.0,
        99.0,
        99.5,
        99.99
    ]
}
