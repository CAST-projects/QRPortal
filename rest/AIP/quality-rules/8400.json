{
    "id": 8400,
    "name": "Avoid having lock on this object",
    "href": "AIP/quality-rules/8400",
    "critical": false,
    "maxWeight": 5,
    "associatedValueName": "Number of violation occurrences",
    "description": "This rule detects all objects having lock on this object.",
    "output": "Associated to each violation, the following information is provided:\n- The number of violation occurrences\n- Bookmarks for violation occurrences found in the source code",
    "rationale": "Software featuring inconsistent locking discipline incurs the risk of deadlock. \nLocking on this or public members is a bad practice because it means the class loses control over the lock. Any other class could use the instance or the public member for synchronization, and impair scalability (best case) or create deadlocks (worst case).",
    "reference": "https://docs.microsoft.com/dotnet/csharp/language-reference/keywords/lock-statement",
    "remediation": "Review and refactor the source code.",
    "remediationSample": "public class Account\n{\n    private readonly object balanceLock = new object();\n    private decimal balance;\n\n    public Account(decimal initialBalance)\n    {\n        balance = initialBalance;\n    }\n\n    public decimal Debit(decimal amount)\n    {\n        lock (balanceLock)\n        {\n            if (balance >= amount)\n            {\n                Console.WriteLine($\"Balance before debit :{balance, 5}\");\n                Console.WriteLine($\"Amount to remove     :{amount, 5}\");\n                balance = balance - amount;\n                Console.WriteLine($\"Balance after debit  :{balance, 5}\");\n                return amount;\n            }\n            else\n            {\n                return 0;\n            }\n        }\n    }\n}",
    "sample": "public class Account\n{\n    private decimal balance;\n\n    public Account(decimal initialBalance)\n    {\n        balance = initialBalance;\n    }\n\n    public decimal Debit(decimal amount)\n    {\n        lock (this)\n        {\n            if (balance >= amount)\n            {\n                Console.WriteLine($\"Balance before debit :{balance, 5}\");\n                Console.WriteLine($\"Amount to remove     :{amount, 5}\");\n                balance = balance - amount;\n                Console.WriteLine($\"Balance after debit  :{balance, 5}\");\n                return amount;\n            }\n            else\n            {\n                return 0;\n            }\n        }\n    }\n}",
    "total": "Number of artifacts",
    "alternativeName": "Avoid having lock on this object",
    "businessCriteria": [
        {
            "id": 1062100,
            "name": "CISQ-Index",
            "href": "AIP/business-criteria/1062100"
        },
        {
            "id": 1062104,
            "name": "CISQ-Security",
            "href": "AIP/business-criteria/1062104"
        },
        {
            "id": 20140522,
            "name": "GreenIT-Index",
            "href": "AIP/business-criteria/20140522"
        },
        {
            "id": 1061000,
            "name": "OMG-ASCQM-Index",
            "href": "AIP/business-criteria/1061000"
        },
        {
            "id": 1061003,
            "name": "OMG-ASCQM-Reliability",
            "href": "AIP/business-criteria/1061003"
        },
        {
            "id": 1061004,
            "name": "OMG-ASCQM-Security",
            "href": "AIP/business-criteria/1061004"
        },
        {
            "id": 60013,
            "name": "Robustness",
            "href": "AIP/business-criteria/60013"
        },
        {
            "id": 60016,
            "name": "Security",
            "href": "AIP/business-criteria/60016"
        }
    ],
    "technicalCriteria": [
        {
            "id": 1062185,
            "name": "ASCSM-CWE-667 - Shared Resource Improper Locking",
            "weight": 5,
            "critical": false
        },
        {
            "id": 1061076,
            "name": "CWE-667: Improper Locking",
            "weight": 5,
            "critical": false
        },
        {
            "id": 66069,
            "name": "Programming Practices - Unexpected Behavior",
            "weight": 5,
            "critical": false
        }
    ],
    "technologies": [
        {
            "id": 138383,
            "name": "C#",
            "href": "AIP/technologies/138383"
        },
        {
            "id": 138385,
            "name": "VB.NET",
            "href": "AIP/technologies/138385"
        }
    ],
    "qualityStandards": [
        {
            "standard": "CISQ",
            "id": "ASCSM-CWE-667",
            "name": "Shared Resource Improper Locking",
            "url": null,
            "description": null
        },
        {
            "standard": "CWE",
            "id": "CWE-250",
            "name": "Execution with Unnecessary Privileges",
            "url": null,
            "description": null
        },
        {
            "standard": "CWE",
            "id": "CWE-667",
            "name": "Improper Locking",
            "url": null,
            "description": null
        },
        {
            "standard": "ISO-5055",
            "id": "CWE-667",
            "name": "Improper Locking",
            "url": null,
            "description": null
        },
        {
            "standard": "NIST-SP-800-53R4",
            "id": "NIST-AC-6",
            "name": "Least Privilege",
            "url": null,
            "description": null
        },
        {
            "standard": "OMG-ASCQM",
            "id": "CWE-667",
            "name": "Improper Locking",
            "url": null,
            "description": null
        }
    ],
    "parameters": [
        
    ],
    "thresholds": [
        50.0,
        90.0,
        95.0,
        99.0
    ]
}
