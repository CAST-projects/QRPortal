{
    "id": 8400,
    "name": "Avoid having lock on this object",
    "href": "AIP/quality-rules/8400",
    "critical": false,
    "maxWeight": 5,
    "associatedValueName": "Single Value",
    "description": "This rule detects all objects having lock on this object.",
    "output": "The rule lists all the artifacts having Lock on this object.",
    "rationale": "\nSoftware featuring inconsistent locking discipline incurs the risk of deadlock. \nLocking on this or public members is a bad practice because it means the class loses control over the lock. Any other class could use the instance or the public member for synchronization, and impair scalability (best case) or create deadlocks (worst case).",
    "reference": "https://docs.microsoft.com/fr-fr/dotnet/csharp/language-reference/keywords/lock-statement\nCISQ - ASCSMCWE667",
    "remediation": "Review and refactor the source code.",
    "sample": "class Account\n{\n    decimal balance;\n\n\n    public void Withdraw(decimal amount)\n    {\n        lock (this)\n        {\n            if (amount > balance)\n            {\n                throw new Exception(\"Insufficient funds\");\n            }\n            balance -= amount;\n        }\n    }\n}",
    "total": "Number of artifacts",
    "alternativeName": "Avoid having lock on \"this\" object (C#)",
    "businessCriteria": [
        {
            "id": 1062100,
            "name": "CISQ-Index",
            "href": "AIP/business-criteria/1062100"
        },
        {
            "id": 1062104,
            "name": "CISQ-Security",
            "href": "AIP/business-criteria/1062104"
        },
        {
            "id": 20140522,
            "name": "Green Stuff",
            "href": "AIP/business-criteria/20140522"
        },
        {
            "id": 60013,
            "name": "Robustness",
            "href": "AIP/business-criteria/60013"
        },
        {
            "id": 60016,
            "name": "Security",
            "href": "AIP/business-criteria/60016"
        }
    ],
    "technicalCriteria": [
        {
            "id": 1062185,
            "name": "ASCSM-CWE-667: Shared Resource Improper Locking",
            "weight": 5,
            "critical": false
        },
        {
            "id": 66069,
            "name": "Programming Practices - Unexpected Behavior",
            "weight": 5,
            "critical": false
        }
    ],
    "technologies": [
        {
            "id": 138383,
            "name": "C#",
            "href": "AIP/technologies/138383"
        },
        {
            "id": 138385,
            "name": "VB.NET",
            "href": "AIP/technologies/138385"
        }
    ],
    "qualityStandards": [
        {
            "standard": "CISQ",
            "id": "ASCSM-CWE-667",
            "name": "Shared Resource Improper Locking",
            "url": null,
            "description": null
        },
        {
            "standard": "CWE",
            "id": "CWE-250",
            "name": "Execution with Unnecessary Privileges",
            "url": null,
            "description": null
        },
        {
            "standard": "CWE",
            "id": "CWE-667",
            "name": "Improper Locking",
            "url": null,
            "description": null
        },
        {
            "standard": "NIST-SP-800-53R4",
            "id": "NIST-AC-6",
            "name": "Least Privilege",
            "url": null,
            "description": null
        },
        {
            "standard": "OMG-ASCQM",
            "id": "CWE-667",
            "name": "Improper Locking",
            "url": null,
            "description": null
        }
    ],
    "parameters": [
        
    ],
    "thresholds": [
        50.0,
        90.0,
        95.0,
        99.0
    ]
}
