{
    "id": 1040016,
    "name": "PermitAll or user role should be specified to access URL(s) of the application",
    "href": "AIP/quality-rules/1040016",
    "critical": true,
    "maxWeight": 7,
    "associatedValueName": "Number of violation occurrences",
    "description": "This rule will check if a permitAll or a user role is specified for accessing any URL path when the URL is specified with .antMatchers() or .loginPage(). If not it gives the violation.",
    "output": "Associated to each violation, the following information is provided:\n- The number of violation occurrences\n- Bookmarks for violation occurrences found in the source code",
    "rationale": "The access to any URL in your application should be secured by using permitAll() to avoid anonymous access or by specifying the role of the user allowed to get access.\nThese expressions are responsible for defining the access control or authorization to specific URLs or methods in your application.\nLet\u2019s look at the example:\n@Override\nprotected void configure(final HttpSecurity http) throws Exception {\n    ...\n    .antMatchers(\"/ForumPage/*\").permittAll()\n    .antMatchers(\"/auth/admin/*\").hasRole(\"ADMIN\")\n    .antMatchers(\"/auth/*\").hasAnyRole(\"ADMIN\",\"USER\")\n\n    ...\n}\n\nIn this example we specify access to all links starting with /auth/ restricted to users that are logged in with role USER or role ADMIN. Moreover, to access links starting with /auth/admin/ we need to have ADMIN role in the system.\nHowever for \"/ForumPage/*\" : all requests are allowed on that particular path ( not anonymous one).Setting the access=\u201dpermitAll\u201d will configure the authorization so that all requests are allowed on that particular path. This is achieved without disabling the security filters \u2013 these still run, so any Spring Security related functionality will still be available.\nThis check is also available for the login page, we should at least specify a .permitAll() for the path login as follow\n  .formLogin()\n            .loginPage(\"/login\")\n            .permitAll()",
    "reference": "https://www.owasp.org/index.php/Top_10-2017_A5-Broken_Access_Control",
    "remediation": "Add .permitAll() for the .loginPage(\"/login\") or .antMatchers(\"/xxx/**\") if access is allowed to anyone.\nor Specify the role with .hasRole(\"ROLE\")",
    "remediationSample": "You need to add .permitAll() for the .loginPage(\"/login\") or .antMatchers(\"/xxx/**\") if access is allowed to anyone.\nor you have to specify the role with .hasRole(\"ROLE\")\n\nJAVA CONFIGURATION\n-----------------------------------------\nprotected void configure(HttpSecurity http) throws Exception {\nhttp\n.authorizeRequests()\n.antMatchers(\"/resources/**\", \"/signup\", \"/about\").permitAll()\n.antMatchers(\"/admin/**\").hasRole(\"ADMIN\") //here the permitall is not specified but the role is specified.\n.antMatchers(\"/db/**\").access(\"hasRole('ADMIN') and hasRole('DBA')\") //here the permitall is not specified but the role is specified.\n.anyRequest().authenticated()\n.and()\n\n.loginPage(\"/login\").permitAll()\n}\n\nXML CONFIGURATION\n-----------------------------------------\nintercept-url pattern=\"/login*\" access=\"permitAll\"",
    "sample": "JAVA CONFIGURATION\n-----------------------------------------\nprotected void configure(HttpSecurity http) throws Exception {\nhttp\n.authorizeRequests()\n.anyRequest().authenticated()\n.and()\n\n.loginPage(\"/login\")\n\n\nXML CONFIGURATION\n-----------------------------------------\nintercept-url pattern=\"/login*\"",
    "total": "Number of Java Methods and XML Files",
    "alternativeName": "Ensure specifying \"PermitAll\" or \"user role\" for URL(s) access to enforce security",
    "businessCriteria": [
        {
            "id": 1061000,
            "name": "ISO-5055-Index",
            "href": "AIP/business-criteria/1061000"
        },
        {
            "id": 1061002,
            "name": "ISO-5055-Performance-Efficiency",
            "href": "AIP/business-criteria/1061002"
        },
        {
            "id": 1061003,
            "name": "ISO-5055-Reliability",
            "href": "AIP/business-criteria/1061003"
        },
        {
            "id": 1061004,
            "name": "ISO-5055-Security",
            "href": "AIP/business-criteria/1061004"
        },
        {
            "id": 1062300,
            "name": "OWASP-2013-Index",
            "href": "AIP/business-criteria/1062300"
        },
        {
            "id": 1062320,
            "name": "OWASP-2017-Index",
            "href": "AIP/business-criteria/1062320"
        },
        {
            "id": 66031,
            "name": "Programming Practices",
            "href": "AIP/business-criteria/66031"
        },
        {
            "id": 60016,
            "name": "Security",
            "href": "AIP/business-criteria/60016"
        }
    ],
    "technicalCriteria": [
        {
            "id": 1061049,
            "name": "CWE-424: Improper Protection of Alternate Path",
            "weight": 5,
            "critical": false
        },
        {
            "id": 1062302,
            "name": "OWASP-2013-A2 Broken Authentication and Session Management",
            "weight": 5,
            "critical": false
        },
        {
            "id": 1062322,
            "name": "OWASP-2017-A2 Broken Authentication",
            "weight": 5,
            "critical": false
        },
        {
            "id": 66062,
            "name": "Secure Coding - Input Validation",
            "weight": 7,
            "critical": true
        }
    ],
    "technologies": [
        {
            "id": 140029,
            "name": "JEE",
            "href": "AIP/technologies/140029"
        }
    ],
    "qualityStandards": [
        {
            "standard": "CWE",
            "id": "CWE-269",
            "name": "Improper Privilege Management",
            "url": "https://cwe.mitre.org/data/definitions/269.html",
            "description": "The software does not properly assign, modify, track, or check privileges for an actor, creating an unintended sphere of control for that actor."
        },
        {
            "standard": "CWE",
            "id": "CWE-284",
            "name": "Improper Access Control",
            "url": "https://cwe.mitre.org/data/definitions/284.html",
            "description": "The software does not restrict or incorrectly restricts access to a resource from an unauthorized actor."
        },
        {
            "standard": "CWE",
            "id": "CWE-285",
            "name": "Improper Authorization",
            "url": "https://cwe.mitre.org/data/definitions/285.html",
            "description": "The software does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action."
        },
        {
            "standard": "CWE",
            "id": "CWE-424",
            "name": "Improper Protection of Alternate Path",
            "url": "https://cwe.mitre.org/data/definitions/424.html",
            "description": "The product does not sufficiently protect all possible paths that a user can take to access restricted functionality or resources."
        },
        {
            "standard": "ISO-5055",
            "id": "CWE-424",
            "name": "Improper Protection of Alternate Path",
            "url": "https://cwe.mitre.org/data/definitions/424.html",
            "description": "The product does not sufficiently protect all possible paths that a user can take to access restricted functionality or resources."
        },
        {
            "standard": "NIST-SP-800-53R4",
            "id": "NIST-IA-9",
            "name": "Service Identification and Authentication",
            "url": "https://nvd.nist.gov/800-53/Rev4/control/IA-9",
            "description": null
        },
        {
            "standard": "OMG-ASCQM",
            "id": "CWE-424",
            "name": "Improper Protection of Alternate Path",
            "url": "https://cwe.mitre.org/data/definitions/424.html",
            "description": "The product does not sufficiently protect all possible paths that a user can take to access restricted functionality or resources."
        },
        {
            "standard": "OWASP",
            "id": "A2-2013",
            "name": "Broken Authentication and Session Management",
            "url": "https://www.owasp.org/index.php/Top_10_2013-A2-Broken Authentication and Session Management",
            "description": "Application functions related to authentication and session management are often not implemented correctly, allowing attackers to compromise passwords, keys, or session tokens, or to exploit other implementation flaws to assume other users' identities."
        },
        {
            "standard": "OWASP",
            "id": "A2-2017",
            "name": "Broken Authentication",
            "url": "https://www.owasp.org/index.php/Top_10-2017_A2-Broken_Authentication",
            "description": "Application functions related to authentication and session management are often implemented incorrectly, allowing attackers to compromise passwords, keys, or session tokens, or to exploit other implementation flaws to assume other users' identities temporarily or permanently."
        },
        {
            "standard": "OWASP",
            "id": "API1-2019",
            "name": "Broken Object Level Authorization",
            "url": null,
            "description": "APIs tend to expose endpoints that handle object identifiers, creating a wide attack surface Level Access Control issue. Object level authorization checks should be considered in every function that accesses a data source using an input from the user."
        },
        {
            "standard": "PCI-DSS-V3.1",
            "id": "PCI-Requirement-6.5.10",
            "name": "Broken authentication and session management",
            "url": null,
            "description": "Note: Requirement 6.5.10 is a best practice until June 30, 2015, after which it becomes a requirement."
        },
        {
            "standard": "PCI-DSS-V3.2.1",
            "id": "PCI-Requirement-6.5.10",
            "name": "Broken authentication and session management",
            "url": null,
            "description": "Note: Requirement 6.5.10 is a best practice until June 30, 2015, after which it becomes a requirement."
        }
    ],
    "parameters": [
        
    ],
    "thresholds": [
        98.0,
        99.0,
        99.5,
        99.99
    ]
}
