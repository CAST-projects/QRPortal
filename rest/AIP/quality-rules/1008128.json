{
    "id": 1008128,
    "name": "Avoid hard-coded IP addresses (RPG400)",
    "href": "AIP/quality-rules/1008128",
    "critical": false,
    "severity": 10,
    "maxWeight": 7,
    "extension": {
        "name": "com.castsoftware.rpg",
        "href": "AIP/extensions/com.castsoftware.rpg"
    },
    "associatedValueName": "Number of violation occurrences",
    "description": "This rule detects hardcoded IPv4 addresses embedded directly in RPG IV source code. It checks string literals in data definitions (D-spec INZ/CONST), free-format expressions (EVAL assignments), named constants (D-spec type C), and procedure call parameters (CALLP). The addresses 0.0.0.0 and 255.255.255.255 are excluded as they represent broadcast/wildcard addresses, not environment-specific endpoints.",
    "output": "Associated to each violation, the following information is provided:\n- The number of violation occurrences\n- Bookmarks for violation occurrences found in the source code",
    "rationale": "Hardcoded IP addresses create tight coupling between application logic and infrastructure configuration. When a server IP changes (e.g., during migration, failover, or environment promotion from development to production), every source file containing that IP must be identified and modified.\n  This leads to deployment errors, downtime, and increases the risk of security vulnerabilities when internal IP addresses are exposed in source code. Centralizing network addresses in configuration files or data areas allows changes without recompilation.",
    "reference": "CWE-1051: Initialization with Hard-Coded Network Resource Configuration Data\nhttps://cwe.mitre.org/data/definitions/1051.html\n\nCISQ Quality Measures - Reliability\nASCRM-RLB-18",
    "remediation": "Replace hardcoded IP addresses with references to data areas, configuration files, or variables populated at runtime from external configuration.",
    "remediationSample": "D SERVER_IP       S             15A\n        /FREE\n         // Retrieve IP from data area at runtime\n         IN *LOCK NETCONFIG;\n         serverAddr = NETCONFIG.SERVER_IP;\n\n         CALLP sendData(serverAddr);                   //  Fixed: value is no more hard-coded\n        /END-FREE",
    "sample": "Pattern 1 \u2014 D-spec INZ with hardcoded IP:\n       D myIP            S             15A   INZ('192.168.1.100')   //  Value is hard-coded\n\n  Pattern 2 \u2014 Free-format EVAL with hardcoded IP:\n        /FREE\n         serverAddr = '10.0.0.1';                              //  Value is hard-coded\n        /END-FREE\n\n  Pattern 3 \u2014 Named constant with hardcoded IP:\n       D SERVER_IP       C                   '172.16.0.1'      //  Value is hard-coded\n\n  Pattern 4 \u2014 CALLP parameter with hardcoded IP:\n        /FREE\n         CALLP sendData('10.1.1.1');                           //  Value is hard-coded\n        /END-FREE",
    "total": "Total number of RPG400 Programs, MainSubRoutine, Subroutine, or Procedure",
    "alternativeName": "Avoid hard-coded IP addresses (RPG400)",
    "businessCriteria": [
        {
            "id": 66032,
            "name": "Architectural Design",
            "href": "AIP/business-criteria/66032"
        },
        {
            "id": 60012,
            "name": "Changeability",
            "href": "AIP/business-criteria/60012"
        },
        {
            "id": 60013,
            "name": "Robustness",
            "href": "AIP/business-criteria/60013"
        },
        {
            "id": 60016,
            "name": "Security",
            "href": "AIP/business-criteria/60016"
        }
    ],
    "technicalCriteria": [
        {
            "id": 61004,
            "name": "Architecture - OS and Platform Independence",
            "href": "AIP/technical-criteria/61004",
            "weight": 7,
            "critical": false
        }
    ],
    "technologies": [
        {
            "id": 1008000,
            "name": "RPG400",
            "href": "AIP/technologies/1008000"
        }
    ],
    "qualityStandards": [
        {
            "id": "ASCRM-RLB-18",
            "name": "Storable and Member Data Element Initialization with Hard-Coded Network Resource Configuration Data",
            "href": "AIP/quality-standards/CISQ/items/ASCRM-RLB-18",
            "standard": "CISQ"
        },
        {
            "id": "CWE-1051",
            "name": "Initialization with Hard-Coded Network Resource Configuration Data",
            "href": "AIP/quality-standards/CWE/items/CWE-1051",
            "standard": "CWE"
        },
        {
            "id": "CWE-1051",
            "name": "Initialization with Hard-Coded Network Resource Configuration Data",
            "href": "AIP/quality-standards/ISO-5055/items/CWE-1051",
            "standard": "ISO-5055"
        },
        {
            "id": "NIST-CM-6",
            "name": "Configuration Settings",
            "href": "AIP/quality-standards/NIST-SP-800-53/items/NIST-CM-6",
            "standard": "NIST-SP-800-53"
        },
        {
            "id": "NIST-CM-6",
            "name": "Configuration Settings",
            "href": "AIP/quality-standards/NIST-SP-800-53R4/items/NIST-CM-6",
            "standard": "NIST-SP-800-53R4"
        },
        {
            "id": "CWE-1051",
            "name": "Initialization with Hard-Coded Network Resource Configuration Data",
            "href": "AIP/quality-standards/OMG-ASCQM/items/CWE-1051",
            "standard": "OMG-ASCQM"
        },
        {
            "id": "A5-2013",
            "name": "Security Misconfiguration",
            "href": "AIP/quality-standards/OWASP/items/A5-2013",
            "standard": "OWASP"
        },
        {
            "id": "A6-2017",
            "name": "Security Misconfiguration",
            "href": "AIP/quality-standards/OWASP/items/A6-2017",
            "standard": "OWASP"
        },
        {
            "id": "A05-2021",
            "name": "Security Misconfiguration",
            "href": "AIP/quality-standards/OWASP/items/A05-2021",
            "standard": "OWASP"
        },
        {
            "id": "API7-2019",
            "name": "Security Misconfiguration",
            "href": "AIP/quality-standards/OWASP/items/API7-2019",
            "standard": "OWASP"
        },
        {
            "id": "API8-2023",
            "name": "Security misconfiguration",
            "href": "AIP/quality-standards/OWASP/items/API8-2023",
            "standard": "OWASP"
        },
        {
            "id": "PCI-Requirement-2.2.4",
            "name": "Configure system security parameters to prevent misuse.",
            "href": "AIP/quality-standards/PCI-DSS-V3.1/items/PCI-Requirement-2.2.4",
            "standard": "PCI-DSS-V3.1"
        },
        {
            "id": "PCI-Requirement-2.2.4",
            "name": "Configure system security parameters to prevent misuse.",
            "href": "AIP/quality-standards/PCI-DSS-V3.2.1/items/PCI-Requirement-2.2.4",
            "standard": "PCI-DSS-V3.2.1"
        },
        {
            "id": "PCI-DSS4-Requirement-1.4.5",
            "name": "The disclosure of internal IP addresses and routing information is limited to only authorized parties.",
            "href": "AIP/quality-standards/PCI-DSS-V4/items/PCI-DSS4-Requirement-1.4.5",
            "standard": "PCI-DSS-V4"
        }
    ],
    "parameters": [
        
    ],
    "thresholds": [
        50.0,
        90.0,
        95.0,
        99.0
    ]
}
