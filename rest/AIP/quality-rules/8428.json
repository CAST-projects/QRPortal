{
    "id": 8428,
    "name": "Authorization check should be done before calling a transaction",
    "href": "AIP/quality-rules/8428",
    "critical": true,
    "maxWeight": 9,
    "associatedValueName": "Number of violation occurrences",
    "description": "Whenever a user manually starts a new transaction, SAP system automatically checks if the user is authorized to execute the transaction. However, these checks are not done by default when a user programmatically starts a new transaction by calling the CALL TRANSACTION statement. If there is no explicit authorization check performed before this statement, the user running the ABAP program will be able to start a transaction that is otherwise not allowed.\n\n\nThe use of the statement CALL TRANSACTION without one of the additions WITH AUTHORITY-CHECK or WITHOUT AUTHORITY-CHECK is now obsolete.",
    "output": "Associated to each violation, the following information is provided:\n- The number of violation occurrences\n- Bookmarks for violation occurrences found in the source code",
    "rationale": "The software does not perform an authorization check when an actor attempts to access a resource or perform an action.",
    "reference": "https://help.sap.com/doc/abapdocu_751_index_htm/7.51/en-US/abapcall_transaction_authority.htm#!ABAP_ADDITION_1@1@",
    "remediation": "Use \"WITH AUTHORITY-CHECK\" addition with \"call transaction\" statements.",
    "remediationSample": "Example 1: The following code calls a transaction that can execute any ABAP program.\n\n\nDATA: carrid TYPE spfli-carrid, \n      connid TYPE spfli-connid. \n\n... \n\nSET PARAMETER ID: 'CAR' FIELD carrid, \n                  'CON' FIELD connid. \n\nTRY: \n    CALL TRANSACTION 'FLIGHT_TA' WITH AUTHORITY-CHECK.  // Violation FIXED\n                                \n    CATCH cx_sy_authorization_error. \n      RETURN. \nENDTRY.",
    "sample": "Example 1: The following code calls a transaction that can execute any ABAP program.\n\n\nDATA: carrid TYPE spfli-carrid, \n      connid TYPE spfli-connid. \n\n... \n\nSET PARAMETER ID: 'CAR' FIELD carrid, \n                  'CON' FIELD connid. \n\nTRY: \n    CALL TRANSACTION 'FLIGHT_TA'. // violation \n                                \n    CATCH cx_sy_authorization_error. \n      RETURN. \nENDTRY.",
    "total": "Number of ABAP Artifacts",
    "alternativeName": "Authorization check should be done before calling a transaction",
    "businessCriteria": [
        {
            "id": 1062300,
            "name": "OWASP-2013-Index",
            "href": "AIP/business-criteria/1062300"
        },
        {
            "id": 1062320,
            "name": "OWASP-2017-Index",
            "href": "AIP/business-criteria/1062320"
        },
        {
            "id": 66031,
            "name": "Programming Practices",
            "href": "AIP/business-criteria/66031"
        },
        {
            "id": 60016,
            "name": "Security",
            "href": "AIP/business-criteria/60016"
        }
    ],
    "technicalCriteria": [
        {
            "id": 1062302,
            "name": "OWASP-2013-A2 Broken Authentication and Session Management",
            "weight": 5,
            "critical": false
        },
        {
            "id": 1062322,
            "name": "OWASP-2017-A2 Broken Authentication",
            "weight": 5,
            "critical": false
        },
        {
            "id": 66062,
            "name": "Secure Coding - Input Validation",
            "weight": 9,
            "critical": true
        }
    ],
    "technologies": [
        {
            "id": -15,
            "name": "ABAP",
            "href": "AIP/technologies/-15"
        }
    ],
    "qualityStandards": [
        {
            "standard": "CWE",
            "id": "CWE-862",
            "name": "Missing Authorization",
            "url": "https://cwe.mitre.org/data/definitions/862.html",
            "description": "The software does not perform an authorization check when an actor attempts to access a resource or perform an action."
        },
        {
            "standard": "NIST-SP-800-53R4",
            "id": "NIST-AC-3",
            "name": "Access Enforcement",
            "url": "https://nvd.nist.gov/800-53/Rev4/control/AC-3",
            "description": null
        },
        {
            "standard": "NIST-SP-800-53R4",
            "id": "NIST-IA-9",
            "name": "Service Identification and Authentication",
            "url": "https://nvd.nist.gov/800-53/Rev4/control/IA-9",
            "description": null
        },
        {
            "standard": "OWASP",
            "id": "A2-2013",
            "name": "Broken Authentication and Session Management",
            "url": "https://www.owasp.org/index.php/Top_10_2013-A2-Broken Authentication and Session Management",
            "description": "Application functions related to authentication and session management are often not implemented correctly, allowing attackers to compromise passwords, keys, or session tokens, or to exploit other implementation flaws to assume other users' identities."
        },
        {
            "standard": "OWASP",
            "id": "A2-2017",
            "name": "Broken Authentication",
            "url": "https://www.owasp.org/index.php/Top_10-2017_A2-Broken_Authentication",
            "description": "Application functions related to authentication and session management are often implemented incorrectly, allowing attackers to compromise passwords, keys, or session tokens, or to exploit other implementation flaws to assume other users' identities temporarily or permanently."
        },
        {
            "standard": "PCI-DSS-V3.1",
            "id": "PCI-Requirement-6.5.10",
            "name": "Broken authentication and session management",
            "url": null,
            "description": "Note: Requirement 6.5.10 is a best practice until June 30, 2015, after which it becomes a requirement."
        },
        {
            "standard": "PCI-DSS-V3.2.1",
            "id": "PCI-Requirement-6.5.10",
            "name": "Broken authentication and session management",
            "url": null,
            "description": "Note: Requirement 6.5.10 is a best practice until June 30, 2015, after which it becomes a requirement."
        }
    ],
    "parameters": [
        
    ],
    "thresholds": [
        50.0,
        90.0,
        95.0,
        99.0
    ]
}
