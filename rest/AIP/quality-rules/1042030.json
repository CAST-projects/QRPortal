{
    "id": 1042030,
    "name": "Avoid Default exclude patterns (excludeParams) in Apache Struts 2.3.20",
    "href": "AIP/quality-rules/1042030",
    "critical": false,
    "maxWeight": 3,
    "associatedValueName": "The number of violation occurrences",
    "description": "Avoid Default exclude patterns (excludeParams) in Apache Struts 2.3.20",
    "output": "Associated to each violation, the following information is provided:\n- The number of violation occurrences\n- Bookmarks for violation occurrences found in the source code",
    "rationale": "Using default settings in version 2.3.20 of struts which includes wrong default exclude patterns gives a chance for an attacker to compromise internal application's state.",
    "reference": "https://cwiki.apache.org/confluence/display/WW/S2-024\nhttps://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-1831",
    "remediation": "Updgrade to 2.3.20.1",
    "remediationSample": "Upgrade Is the best option. \n\nRedefined defaultStack\n<interceptor-stack name=\"myDefaultStack\">\n    <interceptor-ref name=\"exception\"/>\n    <interceptor-ref name=\"alias\"/>\n    <interceptor-ref name=\"servletConfig\"/>\n    <interceptor-ref name=\"i18n\"/>\n    <interceptor-ref name=\"prepare\"/>\n    <interceptor-ref name=\"chain\"/>\n    <interceptor-ref name=\"scopedModelDriven\"/>\n    <interceptor-ref name=\"modelDriven\"/>\n    <interceptor-ref name=\"fileUpload\"/>\n    <interceptor-ref name=\"checkbox\"/>\n    <interceptor-ref name=\"datetime\"/>\n    <interceptor-ref name=\"multiselect\"/>\n    <interceptor-ref name=\"staticParams\"/>\n    <interceptor-ref name=\"actionMappingParams\"/>\n    <interceptor-ref name=\"params\"/>\n    <interceptor-ref name=\"conversionError\"/>\n    <interceptor-ref name=\"validation\">\n        <param name=\"excludeMethods\">input,back,cancel,browse</param>\n    </interceptor-ref>\n    <interceptor-ref name=\"workflow\">\n        <param name=\"excludeMethods\">input,back,cancel,browse</param>\n    </interceptor-ref>\n    <interceptor-ref name=\"debugging\"/>\n    <interceptor-ref name=\"deprecation\"/>\n</interceptor-stack>\n\nand define the following constant in struts.xml\n\n<constant name=\"struts.additional.excludedPatterns\" value=\"^(action|method):.*\"/>",
    "sample": "<interceptors>\n    <interceptor-stack name=\"appDefault\">\n        <interceptor-ref name=\"defaultStack\">\n            <param name=\"exception.logEnabled\">true</param>\n            <param name=\"exception.logLevel\">ERROR</param>\n            <param name=\"params.excludeParams\">dojo..*,^struts..*,^session..*,^request..*,^application..*,^servlet(Request|Response)..*,parameters...*</param>\n        </interceptor-ref>\n    </interceptor-stack>\n</interceptors>\n                             \n<default-interceptor-ref name=\"appDefault\" />",
    "total": "Number of field in struts2 config XML file",
    "businessCriteria": [
        {
            "id": 20140522,
            "name": "Green Stuff",
            "href": "AIP/business-criteria/20140522"
        },
        {
            "id": 60016,
            "name": "Security",
            "href": "AIP/business-criteria/60016"
        }
    ],
    "technicalCriteria": [
        {
            "id": 66064,
            "name": "Secure Coding - Weak Security Features",
            "weight": 3,
            "critical": false
        }
    ],
    "technologies": [
        {
            "id": 140029,
            "name": "JEE",
            "href": "AIP/technologies/140029"
        }
    ],
    "qualityStandards": [
        {
            "standard": "OWASP",
            "id": "A9-2013",
            "name": "Using Components with Known Vulnerabilities",
            "url": "https://www.owasp.org/index.php/Top_10_2013-A9-Using_Components_with_Known_Vulnerabilities",
            "description": "Components, such as libraries, frameworks, and other software modules, almost always run with full privileges. If a vulnerable component is exploited, such an attack can facilitate serious data loss or server takeover. Applications using components with known vulnerabilities may undermine application defenses and enable a range of possible attacks and impacts."
        },
        {
            "standard": "OWASP",
            "id": "A9-2017",
            "name": "Using Components with Known Vulnerabilities",
            "url": "https://www.owasp.org/index.php/Top_10-2017_A9-Using_Components_with_Known_Vulnerabilities",
            "description": "Components, such as libraries, frameworks, and other software modules, run with the same privileges as the application. If a vulnerable component is exploited, such an attack can facilitate serious data loss or server takeover. Applications and APIs using components with known vulnerabilities may undermine application defenses and enable various attacks and impacts."
        }
    ],
    "parameters": [
        
    ],
    "thresholds": [
        50.0,
        90.0,
        95.0,
        99.0
    ]
}
