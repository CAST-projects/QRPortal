{
    "id": 1042046,
    "name": "Avoid Using Dynamic Method Invocation with  Struts  2.3.1.0 ( and Older)",
    "href": "AIP/quality-rules/1042046",
    "critical": true,
    "associatedValueName": "Number of violation occurrences",
    "description": "The \u201cDynamic Method Invocation\u201d (DMI) feature has been intoduced in Struts 2 allowing Action to expose other methods instead of execute()\n\nDMI will use the string following a \u201c!\u201d character in an action name as the name of a method to invoke: A reference to Category!create.action, means using the \u201cCategory\u201d action mapping, but calling 'create' method instead.\n\nAnother way to use DMI is to provide HTTP parameters prefixed with method: in the URL it could be Category.action?method:create=foo, the parameter value is ignored. In POST-Requests that can be used e.g. with a hidden parameter (<s:hidden name=\"method:create\" value=\"foo\" />) or along with a button (<s:submit method=\"create\" />).\n\nThis feature can lead to security problem because any user of the Struts 2 web application can also use DMI to call a public method that is in the Action class (mainly when if POJO actions are used) \nIt's, also, possible to pass a malicious expression which can be used to execute arbitrary code on server side when Dynamic Method Invocation is enabled.\n\n\nWith the release of Struts 2.3.1.1 in December 2011, the security issue with using dynamic method invocation was addressed",
    "output": "Associated to each violation, the following information is provided:\n- The number of violation occurrences\n- Bookmarks for violation occurrences found in the source code",
    "rationale": "Components, such as libraries, frameworks, and other software modules, run with the same privileges as the application. If a vulnerable component is exploited, such an attack can facilitate serious data loss or server takeover. Applications and APIs using components with known vulnerabilities may undermine application defenses and enable various attacks and impacts.",
    "reference": "https://nvd.nist.gov/vuln/detail/CVE-2016-3081\nhttp://cwe.mitre.org/data/definitions/77.html\n\nOWASP Top Ten 2017 Category A1 - Injection\nOWASP Top Ten 2013 Category A1 - Injection\nOWASP Top Ten 2004 Category A6 - Injection Flaws\nOWASP Top Ten 2007 Category A2 - Injection Flaws",
    "remediation": "Disable Dynamic Method Invocation when possible or upgrade to Apache Struts versions 2.3.20.3, 2.3.24.3 or 2.3.28.1.",
    "remediationSample": "Update to the latest Struts2 version( 2.3.15.2 or above)\n\nDisable DMI using on of following approach\n\nInclude this Struts2 property setting in struts.xml:\n<constant name=\"struts.enable.DynamicMethodInvocation\" value=\"false\" />\n\nor in struts.properties:\nstruts.enable.DynamicMethodInvocation = false\n\nor in web.xml, include this init-param node in the Struts 2 filter:\n<init-param>\n<param-name>struts.enable.DynamicMethodInvocation</param-name>\n<param-value>false</param-value>\n</init-param>",
    "sample": "Sample 1\n\nStruts configuration:\n\n    <action name=\"MyAction!*\" class=\"my.Action\" method=\"{1}\">\n        <result name=\"step1\">step1.jsp</result>\n        <result name=\"step2\">step2.jsp</result>         \n        <result name=\"error\">error.jsp</result>\n    </action>\n\nThen my.Action class has various methods that can be called by specifying the name in the URL, eg :\n\nhttp://localhost:8080/MyApp/MyAction!method1.action\n\n\n--------------------------------------------------------\nSample 2\n\n\nConsider below jsp code:\n\n<s:form action=\"calculator_add\" >\n<s:textfield name=\"num1\" label=\"Number 1\"></s:textfield>\n<s:textfield name=\"num2\" label=\"Number 2\"></s:textfield>\n<s:submit action=\"calculator_add\" value=\"Add\" />\n<s:submit action=\"calculator_sub\" value=\"Substract\" />\n</s:form>\n\n\nStruts configuration:\n<package name=\"calc\" extends=\"struts-default\">\n        <action name=\"calculatorInput\">\n            <result>/pages/calculator.jsp</result>\n        </action>\n        <action name=\"calculatorResult\">\n            <result>/pages/calculatorResult.jsp</result>\n        </action>\n        <action name=\"calculator_*\" method=\"{1}\"\n            class=\"com.G2.Actions.CalculatorAction\">\n            <result name=\"success\" type=\"chain\">calculatorResult</result>\n        </action>\n\n</package>\n\nAs you can see, instead of writing different action, action name is provided like \u201ccalculator_*\u201d, and method=\u201d{1}\u201d, means if the input is \u201ccalculator_add\u201d then the add() method will be executed in Action class. That means we can invoke any methods dynamically other than execute() in action class.",
    "total": "Number of struts2 config XML file",
    "alternativeName": "Avoid Using Dynamic Method Invocation with  Struts  2.3.1.0 ( and Older)",
    "businessCriteria": [
        {
            "id": 20140522,
            "name": "Green Stuff",
            "href": "AIP/business-criteria/20140522"
        },
        {
            "id": 60016,
            "name": "Security",
            "href": "AIP/business-criteria/60016"
        }
    ],
    "technicalCriteria": [
        {
            "id": 66064,
            "name": "Secure Coding - Weak Security Features",
            "weight": 8,
            "critical": true
        }
    ],
    "technologies": [
        {
            "id": 140029,
            "name": "JEE",
            "href": "AIP/technologies/140029"
        }
    ],
    "qualityStandards": [
        {
            "standard": "OWASP",
            "id": "A3-2017",
            "name": "Sensitive Data Exposure",
            "url": "https://www.owasp.org/index.php/Top_10-2017_A3-Sensitive_Data_Exposure",
            "description": "Many web applications and APIs do not properly protect sensitive data, such as financial, healthcare, and PII. Attackers may steal or modify such weakly protected data to conduct credit card fraud, identity theft, or other crimes. Sensitive data may be compromised without extra protection, such as encryption at rest or in transit, and requires special precautions when exchanged with the browser."
        },
        {
            "standard": "OWASP",
            "id": "A6-2013",
            "name": "Sensitive Data Exposure",
            "url": "https://www.owasp.org/index.php/Top_10_2013-A6-Sensitive_Data_Exposure",
            "description": "Many web applications do not properly protect sensitive data, such as credit cards, tax IDs, and authentication credentials. Attackers may steal or modify such weakly protected data to conduct credit card fraud, identity theft, or other crimes. Sensitive data deserves extra protection such as encryption at rest or in transit, as well as special precautions when exchanged with the browser."
        },
        {
            "standard": "OWASP",
            "id": "A9-2013",
            "name": "Using Components with Known Vulnerabilities",
            "url": "https://www.owasp.org/index.php/Top_10_2013-A9-Using_Components_with_Known_Vulnerabilities",
            "description": "Components, such as libraries, frameworks, and other software modules, almost always run with full privileges. If a vulnerable component is exploited, such an attack can facilitate serious data loss or server takeover. Applications using components with known vulnerabilities may undermine application defenses and enable a range of possible attacks and impacts."
        },
        {
            "standard": "OWASP",
            "id": "A9-2017",
            "name": "Using Components with Known Vulnerabilities",
            "url": "https://www.owasp.org/index.php/Top_10-2017_A9-Using_Components_with_Known_Vulnerabilities",
            "description": "Components, such as libraries, frameworks, and other software modules, run with the same privileges as the application. If a vulnerable component is exploited, such an attack can facilitate serious data loss or server takeover. Applications and APIs using components with known vulnerabilities may undermine application defenses and enable various attacks and impacts."
        }
    ],
    "parameters": [
        
    ],
    "thresholds": [
        98.0,
        99.0,
        99.5,
        99.99
    ]
}
