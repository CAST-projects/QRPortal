{
    "id": 1040044,
    "name": "Avoid using Spring-integration-zip in versions prior to 1.0.1",
    "href": "AIP/quality-rules/1040044",
    "critical": true,
    "associatedValueName": "Number of violation occurrences",
    "description": "Avoid using Spring-integration-zip in versions prior to 1.0.1",
    "rationale": "spring-integration-zip , versions prior to 1.0.1, exposes an arbitrary file write vulnerability, that can be achieved using a specially crafted zip archive (affects other archives as well, bzip2, tar, xz, war, cpio, 7z), that holds path traversal filenames. So when the filename gets concatenated to the target extraction directory, the final path ends up outside of the target folder.\n\nThis specifically applies to the unzip transformer.\n\nThis can only happen if an application using this library accepts and unpacks zip files from untrusted sources.",
    "reference": "https://pivotal.io/security/cve-2018-1261\nhttp://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-1261\nhttp://cwe.mitre.org/data/definitions/22.html",
    "remediation": "Upgrade to Spring Integration Zip Community Extension Project version 1.0.1.RELEASE",
    "remediationSample": "Upgrade to Spring Integration Zip Community Extension Project version 1.0.1.RELEASE",
    "sample": "import org.springframework.integration.zip.transformer\n//or\n//import org.springframework.integration.*\n\npublic class UnZipTransformer extends AbstractZipTransformer\n{\n..\n}",
    "alternativeName": null,
    "businessCriteria": [
        {
            "id": 66031,
            "name": "Programming Practices",
            "href": "AIP/business-criteria/66031"
        },
        {
            "id": 60016,
            "name": "Security",
            "href": "AIP/business-criteria/60016"
        }
    ],
    "technicalCriteria": [
        {
            "id": 66062,
            "name": "Secure Coding - Input Validation",
            "weight": 7,
            "critical": true
        }
    ],
    "technologies": [
        {
            "id": 140029,
            "name": "JEE",
            "href": "AIP/technologies/140029"
        }
    ],
    "qualityStandards": [
        {
            "standard": "CISQ",
            "id": "ASCSM-CWE-22",
            "name": "Path Traversal Improper Input Neutralization",
            "url": null,
            "description": "Objective\nAvoid failure to sanitize user input in use in path manipulation operations\n\nConsequence\nSoftware that is unaware of file path control incurs the risk of exposition of sensitive data, the risk of corruption of critical files, such as programs, libraries, or important data used in protection mechanisms\n\nMeasure Element\nNumber of instances where an external value is entered into the application through the user interface ReadsUI action, transformed throughout the application along the sequence composed of ActionElements with DataRelations relations, some of which being part of named callable and method control elements, and ultimately used in the file path creation statement; none of the callable or method control element of the transformation sequence being a vetted sanitization control element from the list of vetted sanitization control elements.\n\n"
        },
        {
            "standard": "CWE",
            "id": "CWE-22",
            "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
            "url": "https://cwe.mitre.org/data/definitions/22.html",
            "description": "The software uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the software does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory."
        },
        {
            "standard": "PCI-DSS-V3.1",
            "id": "PCI-Requirement-6.5.1",
            "name": "Injection flaws, particularly SQL injection. Also consider OS Command Injection, LDAP and XPath injection flaws as well as other injection flaws.",
            "url": null,
            "description": null
        }
    ],
    "parameters": [
        
    ],
    "thresholds": [
        98.0,
        99.0,
        99.5,
        99.99
    ]
}
