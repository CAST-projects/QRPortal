{
    "id": 8214,
    "name": "CWE-672: Expired or Released Resource should not be used",
    "href": "AIP/quality-rules/8214",
    "critical": true,
    "severity": 20,
    "maxWeight": 8,
    "associatedValueName": "Associated Value",
    "description": "If a released resource is subsequently reused or reallocated, then an attempt to use the original resource might allow access to sensitive data that is associated with a different user or entity.\n  This rule reports all methods acessing the closed SQL connections or data streams which are not valid. The following methods are taken into account:\n  \n- JDBC:\n   . close: java.sql.Connection.close()\n   . close: java.sql.Statement.close()\n   . close: java.sql.PreparedStatement.close()\n   . close: java.sql.CallableStatement.close()\n   . close: java.sql.ResultSet.close()\n- JPA:\n   . close: javax.persistence.EntityManagerFactory.close()\n   . close:  javax.persistence.EntityManager.close()\n- Hibernate:\n    . close: org.hibernate.Session.close()\n  . close: org.hibernate.SessionFactory.close()\n- Spring:\n    . close: org.springframework.orm.hibernate3.SessionFactoryUtils.closeSession(...)\n  \n-The following objects are taken into account:\n- output streams\n- input streams\n- readers\n- writers\n- channel\n  ",
    "output": "This report lists all methods that access the closed SQL connections or data streams which are not valid \nIt provides the following information: \n- method full name",
    "rationale": "This mainly comes from an incorrect code that by mistake access the invalid resource which was closed by the object. Invalid resource access shall make production applications down at runtime.",
    "reference": "https://cwe.mitre.org/data/definitions/672.html",
    "remediation": "You can use:\n- isClosed() methods before accessing the Connection object .\n- close() method should be always before closing the application.\n ",
    "remediationSample": "with finally\n~~~~~~~~~~~~\nif(!connection.isClosed())\n  connection.prepareStatement(\"select * from ....\");\nor\nfinally{\n      System.out.println(\"Closing a conection\");\n      connection.close();\n}",
    "sample": "String connectionUrl=\"jdbc:mysql://localhost:3306/MyDb\";\n    String userName=\"root\";\n    String userPass=\"root\";\n    DBConnectionInvalid connectionExample=new DBConnectionInvalid();\n    try{\n      connection=connectionExample.getConnection(connectionUrl, userName, userPass);\n    }catch(Exception e){\n      System.out.println(e.toString());\n    }finally{\n      System.out.println(\"Closing a conection\");\n      connection.close();\n      System.out.println(\"Connection closed.........\");\n      if(!connection.isClosed())\n      {\n        connection.prepareStatement(\"select * from ....\");\n      }\n    }",
    "total": "All the methods that open a database resource in the body",
    "alternativeName": "Ensure not using expired or released database resource to prevent access to sensitive data that is associated with a different user or entity.",
    "businessCriteria": [
        {
            "id": 1062100,
            "name": "CISQ-Index",
            "href": "AIP/business-criteria/1062100"
        },
        {
            "id": 60014,
            "name": "Efficiency",
            "href": "AIP/business-criteria/60014"
        },
        {
            "id": 66031,
            "name": "Programming Practices",
            "href": "AIP/business-criteria/66031"
        },
        {
            "id": 60016,
            "name": "Security",
            "href": "AIP/business-criteria/60016"
        }
    ],
    "technicalCriteria": [
        {
            "id": 1062186,
            "name": "ASCSM-CWE-672 - Expired or Released Resource Usage",
            "href": "AIP/technical-criteria/1062186",
            "weight": 5,
            "critical": false
        },
        {
            "id": 61018,
            "name": "Efficiency - Memory, Network and Disk Space Management",
            "href": "AIP/technical-criteria/61018",
            "weight": 8,
            "critical": true
        }
    ],
    "technologies": [
        {
            "id": 140029,
            "name": "JEE",
            "href": "AIP/technologies/140029"
        }
    ],
    "qualityStandards": [
        {
            "id": "ASCSM-CWE-672",
            "name": "Expired or Released Resource Usage",
            "href": "AIP/quality-standards/CISQ/items/ASCSM-CWE-672",
            "standard": "CISQ"
        },
        {
            "id": "CWE-672",
            "name": "Operation on a Resource after Expiration or Release",
            "href": "AIP/quality-standards/CWE/items/CWE-672",
            "standard": "CWE"
        },
        {
            "id": "CWE-672",
            "name": "Operation on a Resource after Expiration or Release",
            "href": "AIP/quality-standards/ISO-5055/items/CWE-672",
            "standard": "ISO-5055"
        },
        {
            "id": "NIST-AC-3",
            "name": "Access Enforcement",
            "href": "AIP/quality-standards/NIST-SP-800-53/items/NIST-AC-3",
            "standard": "NIST-SP-800-53"
        },
        {
            "id": "NIST-AC-3",
            "name": "Access Enforcement",
            "href": "AIP/quality-standards/NIST-SP-800-53R4/items/NIST-AC-3",
            "standard": "NIST-SP-800-53R4"
        },
        {
            "id": "CWE-672",
            "name": "Operation on a Resource after Expiration or Release",
            "href": "AIP/quality-standards/OMG-ASCQM/items/CWE-672",
            "standard": "OMG-ASCQM"
        }
    ],
    "parameters": [
        
    ],
    "thresholds": [
        90.0,
        95.0,
        99.0,
        100.0
    ]
}
