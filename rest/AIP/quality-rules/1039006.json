{
    "id": 1039006,
    "name": "Avoid using predictable SecureRandom Seeds",
    "href": "AIP/quality-rules/1039006",
    "critical": true,
    "severity": 20,
    "maxWeight": 7,
    "extension": {
        "name": "com.castsoftware.jeerules",
        "href": "AIP/extensions/com.castsoftware.jeerules"
    },
    "associatedValueName": "Number of violation occurrences",
    "description": "This rule reports violation when SecureRandom.setSeed() or SecureRandom(byte[]) are called with a seed that is either of: \n\n- constant \n- System.currentTimeMillis()",
    "output": "Associated to each violation, the following information is provided:\n- The number of violation occurrences\n- Bookmarks for violation occurrences found in the source code",
    "rationale": "The java.security.SecureRandom class provides a strong random number generator (RNG) appropriate for cryptography. However, seeding it with a constant or another predictable value will weaken it significantly. In general, it is much safer to rely on the seed provided by the SecureRandom implementation. \n\nThe use of predictable seeds significantly reduces the number of possible seeds that an attacker would need to test in order to predict which random numbers will be generated by the RNG",
    "reference": "http://cwe.mitre.org/data/definitions/337.html \nhttp://cwe.mitre.org/data/definitions/336.html",
    "remediation": "Use of predictable seeds is not recommended.",
    "remediationSample": "# Sample 1\nSecureRandom sr = new SecureRandom();\nint v = sr.next(32);\n\nsr = new SecureRandom();\nv = sr.next(32);\n\n# Sample 2\nRandom random = new Random();\nint accountID = random.nextInt();\n\n# Sample 3\npublic static void encrypt(String data)\n{\n    SecureRandom random = new SecureRandom();\n    byte[] seed = random.generateSeed(16);\n    random.setSeed(seed);\n\n    byte[] initVector = new byte[16];\n    random.nextBytes(initVector);\n\n    byte[] key = new byte[16];\n    random.nextBytes(key) ;\n}",
    "sample": "# Sample 1\nSecureRandom sr = new SecureRandom(); \nsr.setSeed(123456L); // VIOLATION \nint v = sr.next(32); \n\nsr = new SecureRandom(\"abcdefghijklmnop\".getBytes(\"us-ascii\")); // VIOLATION \nv = sr.next(32); \n\n# Sample 2 \nRandom random = new Random(System.currentTimeMillis()); // VIOLATION \nint accountID = random.nextInt();\n\n# Sample 3\npublic static void encrypt(String data)\n{\n    long seed = 123456;\n    SecureRandom random = new SecureRandom();\n    random.setSeed(seed);\n\n    byte[] initVector = new byte[16];\n    random.nextBytes(initVector);\n\n    byte[] key = new byte[16];\n    random.nextBytes(key) ;\n}",
    "total": "Number of Java artifacts",
    "alternativeName": "Ensure that you are not using predictable SecureRandom Seeds",
    "businessCriteria": [
        {
            "id": 20140522,
            "name": "Green",
            "href": "AIP/business-criteria/20140522"
        },
        {
            "id": 66031,
            "name": "Programming Practices",
            "href": "AIP/business-criteria/66031"
        },
        {
            "id": 60013,
            "name": "Robustness",
            "href": "AIP/business-criteria/60013"
        },
        {
            "id": 60016,
            "name": "Security",
            "href": "AIP/business-criteria/60016"
        }
    ],
    "technicalCriteria": [
        {
            "id": 1062305,
            "name": "OWASP-2013-A5 - Security Misconfiguration",
            "href": "AIP/technical-criteria/1062305",
            "weight": 5,
            "critical": false
        },
        {
            "id": 1062326,
            "name": "OWASP-2017-A6 - Security Misconfiguration",
            "href": "AIP/technical-criteria/1062326",
            "weight": 5,
            "critical": false
        },
        {
            "id": 1062342,
            "name": "OWASP-2021-A02 - Cryptographic Failures",
            "href": "AIP/technical-criteria/1062342",
            "weight": 5,
            "critical": false
        },
        {
            "id": 1063152,
            "name": "PCI-DSS4-Requirement-2.2.6 - System security parameters are configured to prevent misuse",
            "href": "AIP/technical-criteria/1063152",
            "weight": 5,
            "critical": false
        },
        {
            "id": 1063153,
            "name": "PCI-DSS4-Requirement-3.6.1 - Procedures are defined and implemented to protect cryptographic keys",
            "href": "AIP/technical-criteria/1063153",
            "weight": 5,
            "critical": false
        },
        {
            "id": 1063103,
            "name": "PCI-Requirement-2.2.4 - Configure system security parameters to prevent misuse.",
            "href": "AIP/technical-criteria/1063103",
            "weight": 5,
            "critical": false
        },
        {
            "id": 1063108,
            "name": "PCI-Requirement-3.6.1 - Generation of strong cryptographic keys",
            "href": "AIP/technical-criteria/1063108",
            "weight": 5,
            "critical": false
        },
        {
            "id": 66065,
            "name": "Secure Coding - Time and State",
            "href": "AIP/technical-criteria/66065",
            "weight": 7,
            "critical": true
        }
    ],
    "technologies": [
        {
            "id": 140029,
            "name": "JEE",
            "href": "AIP/technologies/140029"
        }
    ],
    "qualityStandards": [
        {
            "id": "CWE-336",
            "name": "Same Seed in Pseudo-Random Number Generator (PRNG)",
            "href": "AIP/quality-standards/CWE/items/CWE-336",
            "standard": "CWE"
        },
        {
            "id": "CWE-337",
            "name": "Predictable Seed in Pseudo-Random Number Generator (PRNG)",
            "href": "AIP/quality-standards/CWE/items/CWE-337",
            "standard": "CWE"
        },
        {
            "id": "A5-2013",
            "name": "Security Misconfiguration",
            "href": "AIP/quality-standards/OWASP/items/A5-2013",
            "standard": "OWASP"
        },
        {
            "id": "A6-2017",
            "name": "Security Misconfiguration",
            "href": "AIP/quality-standards/OWASP/items/A6-2017",
            "standard": "OWASP"
        },
        {
            "id": "A02-2021",
            "name": "Cryptographic Failures",
            "href": "AIP/quality-standards/OWASP/items/A02-2021",
            "standard": "OWASP"
        },
        {
            "id": "API7-2019",
            "name": "Security Misconfiguration",
            "href": "AIP/quality-standards/OWASP/items/API7-2019",
            "standard": "OWASP"
        },
        {
            "id": "PCI-Requirement-2.2.4",
            "name": "Configure system security parameters to prevent misuse.",
            "href": "AIP/quality-standards/PCI-DSS-V3.1/items/PCI-Requirement-2.2.4",
            "standard": "PCI-DSS-V3.1"
        },
        {
            "id": "PCI-Requirement-3.6.1",
            "name": "Generation of strong cryptographic keys",
            "href": "AIP/quality-standards/PCI-DSS-V3.1/items/PCI-Requirement-3.6.1",
            "standard": "PCI-DSS-V3.1"
        },
        {
            "id": "PCI-Requirement-2.2.4",
            "name": "Configure system security parameters to prevent misuse.",
            "href": "AIP/quality-standards/PCI-DSS-V3.2.1/items/PCI-Requirement-2.2.4",
            "standard": "PCI-DSS-V3.2.1"
        },
        {
            "id": "PCI-Requirement-3.6.1",
            "name": "Generation of strong cryptographic keys",
            "href": "AIP/quality-standards/PCI-DSS-V3.2.1/items/PCI-Requirement-3.6.1",
            "standard": "PCI-DSS-V3.2.1"
        },
        {
            "id": "PCI-DSS4-Requirement-2.2.6",
            "name": "System security parameters are configured to prevent misuse",
            "href": "AIP/quality-standards/PCI-DSS-V4/items/PCI-DSS4-Requirement-2.2.6",
            "standard": "PCI-DSS-V4"
        },
        {
            "id": "PCI-DSS4-Requirement-3.6.1",
            "name": "Procedures are defined and implemented to protect cryptographic keys",
            "href": "AIP/quality-standards/PCI-DSS-V4/items/PCI-DSS4-Requirement-3.6.1",
            "standard": "PCI-DSS-V4"
        },
        {
            "id": "STIG-V-222596",
            "name": "The application must protect the confidentiality and integrity of transmitted information.",
            "href": "AIP/quality-standards/STIG-V5/items/STIG-V-222596",
            "standard": "STIG-V5"
        }
    ],
    "parameters": [
        
    ],
    "thresholds": [
        98.0,
        99.0,
        99.5,
        99.99
    ]
}
